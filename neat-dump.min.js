var d=function(){function a(){this.hasNode=!0,this.hasBrowser=!0,this.hasJasmine=!0,this.beQuiet=!1,this.showSourceLine=!0,this.showStackTrace=!1,this.showTimestamp=!1,this.showErrorLevel=!1,this.showFunctions=!1,this.debugTesting=!1,this.displayFunction=h;try{module.id}catch(a){this.hasNode=!1}try{window.jasmine.Env}catch(a){this.hasJasmine=!1}this.hasBrowser=!this.hasNode,this.hasJasmine||(this.hasBrowser?this.displayFunction=j:this.hasNode&&(this.displayFunction=k,this.showTimestamp=!0,this.showErrorLevel=!0,this.showSourceLine=!1))}function b(a){for(var b=0;b<r.length;b++)if(a===r[b])return!0;return r.push(a),!1}function c(a,d){d=d||0,d||(r=[]);var e,f="";if(a instanceof Error)return a.stack;if(a instanceof Array){if(b(a))return"*recursion*";for(f+="[",e=0;e<a.length;e++)"["!==f&&(f+=", "),f+=c(a[e],d+1);f+="]"}else if(a instanceof Function)f=t.config.showFunctions?"function "+a.name+"(){...}":"";else if(a instanceof Object){if(b(a))return"*recursion*";if(a.toString!=={}.toString)f+=a.toString();else{f+="{";var g=Object.getOwnPropertyNames(a).sort();for(e=0;e<g.length;e++)a[g[e]]instanceof Function||("{"!==f&&(f+=", "),f+=g[e]+": ",f+=c(a[g[e]],d+1));f+="}"}}else f+=JSON.stringify(a);return f}function d(a){return a=c(a),a=a.replace(/^"(.*)"$/,"$1"),a=a.replace(/^'(.*)'$/,"$1")}function e(){return(new Date).toJSON().substr(11,8)}function f(a){for(var b="",c=0;c<a.length;c++)c&&(b+=" "),b+=d(a[c]);return b}function g(a,b,c,d,e){this.level=a,this.channel=b,this.type=c,this.prefix=d,this.args=e,this.text=f(e)}function h(a){var b=a.prefix;null!==a.channel&&(b+=" ["+a.channel+"] "),b+=a.text,console.log(b)}function j(a){var b=a.args;switch(null!==a.channel&&b.unshift("["+a.channel+"]"),""!==a.prefix&&b.unshift(a.prefix.trim()),a.level){case p.DEBUG:console.debug.apply(console,b);break;case p.INFO:console.info.apply(console,b);break;case p.WARNING:console.warn.apply(console,b);break;case p.ERROR:case p.FATAL:console.error.apply(console,b);break;default:console.log.apply(console,b)}}function k(a){var b=a.text,c=a.prefix,d="",e="";switch(c=c.trim(),null!==a.channel&&(c+=" ["+a.channel+"]"),a.level){case p.DEBUG:d="[32m",e="[0m";break;case p.INFO:d="[32m",e="[0m";break;case p.WARNING:d="[35m",e="[0m";break;case p.ERROR:case p.FATAL:case p.RED:d="[31m",e="[0m"}"line"==a.type&&(d="[1;30m",e="[0m"),console.log(d,c,b,e)}function l(a,b){if(0!==b.length){if(t.config.displayFunction&&!t.config.beQuiet){var c,d,f,h=new Error("Stack trace");if(h.stack){f=h.stack.split("\n"),f.splice(0,3);var i=/\((.*)\)/.exec(f[0]);i?d=i[1]:(i=/^\s+at\s+(.*)/.exec(f[0]),d=i?i[1]:f[0].trim())}else d="unknown";var j=null;if(Object.keys(q).length>0)if(b[0]in q){if(!q[b[0]])return b[b.length-1];j=b[0],b=b.splice(1)}else if(j="GENERAL",j in q&&!q[j])return b[b.length-1];var k="";if(t.config.showTimestamp&&(k+=e()+" "),t.config.showErrorLevel&&(k+=a+": "),t.config.showStackTrace){c=new g(a,j,"stack",k,["________________________________________________________________________________________"]),t.config.displayFunction(c);for(var l=0;l<f.length;l++)c=new g(a,j,"stack",k,[f[l]]),t.config.displayFunction(c)}else t.config.showSourceLine&&(c=new g(a,j,"line",k,["==",d,"=="]),t.config.displayFunction(c));for(var m=Object.keys(s),n=0;n<b.length;n++)for(var o=b[n],p=0;p<m.length;p++)if(s[m[p]].check(o)){b[n]=s[m[p]].convert(o);break}c=new g(a,j,"message",k,b),t.config.displayFunction(c)}return b[b.length-1]}}function m(a){this.message=a}function n(a){this.message=a,this.stack=(new Error).stack}function o(a){function b(a,d){function e(a,b,e){try{jasmine&&expect(!0).toBe(!0)}catch(f){}if(b+=" (had "+c(e)+")",!a&&!d)throw new n("Dump Expectation Failed: expected to "+b);if(a&&d)throw new n("Dump Expectation Failed: expected not to "+b)}function f(b){var c=[];for(i=0;i<a.length;i++)if("message"===a[i].type){if(b&&!b(a[i]))continue;c.push(a[i].text)}return c}d||(this.not=new b(a,(!0))),this.toHaveMessages=function(){e(a.length>0,"have some messages",a.length)},this.toBe=function(){var a=Array.prototype.slice.call(arguments),b=f(function(a){return null===a.channel||"GENERAL"===a.channel}),c=!1;if(a.length==b.length){c=!0;for(var d=0;d<a.length;d++)if(a[d]!==b[d]){c=!1;break}}e(c,"have exactly "+a.length+" messages ['"+a.join("', '")+"']",b)}}function d(a){e.push(a),t.config.debugTesting&&f(a)}var e=[],f=t.config.displayFunction;t.config.displayFunction=d;try{a()}catch(g){if(!(g instanceof m))throw t.config.displayFunction=f,g}return t.config.displayFunction=f,new b(e)}var p={DEBUG:"DEBUG",INFO:"INFO",WARNING:"WARNING",ERROR:"ERROR",FATAL:"FATAL",RED:"RED",GREEN:"GREEN",BLUE:"BLUE",YELLOW:"YELLOW"},q={},r=[],s={ember:{check:function(a){try{if(!Ember)return!1}catch(b){return!1}return!!a&&!!a.__ember_meta__},convert:function(a){if(a.eachAttribute){var b=new function(){};return b.id=a.get("id"),b["class"]=a.get("constructor.modelName"),b.data={},a.eachAttribute(function(c,d){b.data[c]=a.get(c)}),b}if(a.objectAt){b=[];for(var c=0;c<a.length;c++)b.push(s.ember.convert(a.objectAt(c)));return b}return{EmberObject:"Unidentified by neat-dump."}}}};m.prototype=Object.create(Error.prototype),m.prototype.name="DumpError",m.prototype.constructor=m,n.prototype=Object.create(Error.prototype),n.prototype.name="DumpExceptionError",n.prototype.constructor=n;var t=function(){var a=Array.prototype.slice.call(arguments);return l(p.DEBUG,a)};return t.config=new a,t.info=function(){var a=Array.prototype.slice.call(arguments);return l(p.INFO,a)},t.warning=function(){var a=Array.prototype.slice.call(arguments);return l(p.WARNING,a)},t.error=function(){var a=Array.prototype.slice.call(arguments);return l(p.ERROR,a)},t.fatal=function(){var a=Array.prototype.slice.call(arguments);throw l(p.FATAL,a),new m("FATAL: "+f(a))},t.channels=function(a){for(var b in a)b in q?null!==a[b]&&(q[b]=a[b]):q[b]=a[b]},t.expect=function(a){return o(a)},t.red=function(){var a=Array.prototype.slice.call(arguments);return l(p.RED,a)},t.middleware=function(){return function(a,b,c){var d="["+a.ip+"] "+a.method+" "+a.originalUrl,f=new g("INFO",null,"message","[33m"+e()+" ",[d]);k(f),c()}},t}();d.config.hasNode&&(module.exports=d);